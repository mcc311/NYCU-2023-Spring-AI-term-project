❯ g++ td_learning.cpp -std=c++20 -o td -O3
❯ ./td
60.53 20.46 20.61 20.46 20.51 20.5 20.63 20.63 20.59 20.54 20.62 21.4 20.97 20.41 20.4 20.45 
2-0.014 2-0.031 2-0.011 2-0.0093 2-0.011 2-0.0045 2-0.024 2-0.004 2-0.016 2-0.03 2-0.0052 2-0.019 2-0.0069 2-0.0021 2-0.0042 20.0089 
Epoch 1 ( 4.3 sec) || train loss: 0.22 || test loss: 0.19
20.49 20.56 20.52 20.56 20.58 20.54 20.68 20.46 20.61 20.36 20.71 21.2 20.87 20.44 20.44 20.39 
2-0.0071 2-0.011 2-0.0084 2-0.014 2-0.0058 2-0.0067 2-0.0064 2-0.013 2-0.0031 2-0.0077 2-0.0026 2-0.0031 2-0.00022 2-0.011 2-0.01 2-0.0076 
Epoch 2 ( 4.2 sec) || train loss: 0.22 || test loss: 0.2
20.6 20.48 20.61 20.47 20.63 20.56 20.52 20.65 20.62 20.56 20.57 21.2 20.48 20.55 20.39 20.64 
20.008 20.0051 20.0088 20.0047 20.0091 20.0065 20.0078 20.0093 20.011 20.0088 20.0068 20.021 20.0055 20.0064 20.003 20.0047 
Epoch 3 ( 4.4 sec) || train loss: 0.21 || test loss: 0.2
20.5 20.46 20.46 20.47 20.52 20.47 20.65 20.46 20.46 20.56 20.43 21.5 21 20.36 20.54 20.56 
2-0.0044 2-0.0072 2-0.002 2-0.0058 2-0.0041 2-0.0028 20.00059 2-0.0016 20.0018 2-0.0038 2-0.0072 20.019 20.0048 2-0.015 2-0.0049 20.0045 
Epoch 4 ( 4.3 sec) || train loss: 0.21 || test loss: 0.2
20.46 20.54 20.63 20.33 20.62 20.66 20.57 20.58 20.59 20.41 20.52 20.99 20.43 20.52 20.45 20.5 
2-0.0078 2-0.0011 2-0.00068 2-0.0064 2-0.00036 2-0.0027 2-0.0037 2-0.00034 2-0.0013 2-0.0049 2-0.0069 20.0048 2-0.006 2-0.0024 2-0.0032 20.0048 
Epoch 5 ( 4.7 sec) || train loss: 0.21 || test loss: 0.24
20.58 20.39 20.51 20.44 20.54 20.65 20.44 20.58 20.6 20.38 20.55 21.5 20.69 20.43 20.45 20.52 
20.0071 20.00088 20.0055 20.0029 20.0047 20.0046 20.0034 20.0048 20.0042 20.0024 20.006 20.026 20.0096 20.0044 20.0046 20.0038 
Epoch 6 ( 5 sec) || train loss: 0.21 || test loss: 0.21
^C
❯ g++ td_learning.cpp -std=c++20 -o td -O3
❯ ./td
0.56 0.49 0.6 0.55 0.5 0.68 0.62 0.33 0.52 0.39 0.58 1.6 0.88 0.43 0.52 0.47 
0.0076 0.0052 0.0082 0.0067 0.0072 0.01 0.0092 0.0041 0.0078 0.0042 0.0077 0.028 0.013 0.0053 0.0052 0.0033 
Epoch 1 ( 4.55 sec) || train loss: 0.218 || test loss: 0.205
^C
❯ g++ td_learning.cpp -std=c++20 -o td -O3
❯ ./td
0.9 0.81 0.89 0.81 0.86 0.85 0.83 0.91 0.98 3.2 2.1 0.81 
0.00025 -0.0072 0.00089 -0.0026 0.001 -0.0013 0.0011 0.0088 0.0056 0.045 0.025 -0.0087 
Epoch 1 ( 2.72 sec) || train loss: 0.828 || test loss: 0.661
0.85 0.86 0.89 0.78 0.82 0.84 0.92 0.86 0.83 3.4 1.2 1.1 
-0.0022 0.0082 0.0028 0.0016 -0.00033 0.0052 0.00016 -0.011 0.0013 0.042 0.013 0.013 
Epoch 2 ( 2.7 sec) || train loss: 0.528 || test loss: 0.506
0.9 0.84 0.77 0.96 0.85 0.84 0.92 0.77 1.1 2.8 1.8 0.8 
-0.0058 -0.013 0.0095 -0.0023 -0.013 -0.0044 -0.009 -0.02 0.016 0.047 0.014 -0.0054 
Epoch 3 ( 2.85 sec) || train loss: 0.396 || test loss: 0.389
0.91 0.84 0.8 1.1 0.89 0.97 1.2 0.74 1.1 1 1.5 0.82 
0.01 -0.0083 -0.014 0.0011 0.0028 -0.0055 0.0062 -0.0068 -0.004 0.0063 0.01 -0.018 
Epoch 4 ( 2.75 sec) || train loss: 0.327 || test loss: 0.371
0.78 0.65 0.82 0.64 0.76 0.78 0.66 0.69 0.61 2.8 1.9 0.65 
0.0053 0.0051 0.0068 0.0045 0.0056 0.0078 0.0037 0.0032 0.0029 0.05 0.029 0.0029 
Epoch 5 ( 2.71 sec) || train loss: 0.286 || test loss: 0.336
0.89 0.65 0.74 0.64 0.76 0.82 0.98 0.68 0.73 2.5 1.2 0.86 
-0.0096 -0.031 -0.0015 -0.0051 -0.01 -0.0055 0.003 -0.0022 0.0052 0.031 0.0085 -0.0091 
Epoch 6 ( 2.7 sec) || train loss: 0.259 || test loss: 0.303
0.63 0.78 0.71 0.69 0.79 0.75 0.69 0.63 0.82 2.1 1.8 0.69 
0.011 0.015 0.013 0.013 0.015 0.014 0.013 0.011 0.015 0.041 0.035 0.013 
Epoch 7 ( 2.7 sec) || train loss: 0.241 || test loss: 0.287
0.66 0.73 0.77 0.73 0.59 0.86 0.68 0.55 0.7 0.86 1.7 0.88 
0.002 0.0012 -0.0014 -0.0018 -0.0043 -0.0042 -0.0011 -0.0026 0.002 0.0065 0.01 -0.00031 
Epoch 8 ( 2.71 sec) || train loss: 0.229 || test loss: 0.33
0.87 0.61 0.5 0.7 0.7 0.67 0.7 0.67 1 2.3 1.9 0.5 
-0.0021 -0.0061 -0.015 -0.012 0.0024 -0.007 -0.014 -0.00075 -0.0052 0.021 0.012 -0.0047 
Epoch 9 ( 2.7 sec) || train loss: 0.217 || test loss: 0.254
0.5 0.48 0.56 0.49 0.51 0.57 0.38 0.52 0.58 2.7 1.6 0.55 
-0.017 -0.012 -0.014 -0.011 -0.0065 -0.01 -0.013 -0.0035 -0.009 0.035 0.012 -0.02 
Epoch 10 ( 2.7 sec) || train loss: 0.212 || test loss: 0.323
0.88 0.62 0.45 0.66 0.65 0.69 0.6 0.7 0.91 2.2 1.3 0.66 
0.0036 -0.0011 0.0014 0.0029 0.0027 0.0014 0.0026 0.0041 0.012 0.037 0.018 -0.00071 
Epoch 11 ( 2.7 sec) || train loss: 0.206 || test loss: 0.252
0.61 0.49 0.72 0.66 0.65 0.51 0.51 0.69 0.78 2.4 1.5 0.49 
-0.013 -0.0066 -0.0046 -0.0047 -0.0035 -0.0089 -0.0038 -0.0029 -0.004 0.036 0.01 -0.0086 
Epoch 12 ( 2.71 sec) || train loss: 0.2 || test loss: 0.258
0.79 0.55 0.48 0.48 0.59 0.41 0.55 0.76 0.62 1.4 1.8 0.5 
0.0085 0.0031 -0.0002 0.0024 0.0069 0.0011 0.0057 0.013 0.0043 0.024 0.031 0.0024 
Epoch 13 ( 2.7 sec) || train loss: 0.197 || test loss: 0.29
0.73 0.57 0.75 0.66 0.52 0.48 0.35 0.47 0.64 2.9 1.2 0.69 
0.012 0.009 0.012 0.011 0.0086 0.0068 0.0043 0.0069 0.01 0.058 0.022 0.012 
Epoch 14 ( 2.7 sec) || train loss: 0.193 || test loss: 0.259
0.63 0.57 0.4 0.61 0.41 0.55 0.5 0.38 0.52 2.2 1.6 0.47 
-0.017 -0.006 -0.014 -0.0084 -0.018 -0.0078 -0.0094 -0.022 -0.019 0.025 0.0096 -0.0043 
Epoch 15 ( 2.72 sec) || train loss: 0.19 || test loss: 0.285
0.62 0.58 0.81 0.59 0.63 0.6 0.75 0.83 0.78 0.26 1.7 0.25 
-0.014 -0.018 -0.029 -0.0016 -0.017 -0.0094 -0.012 -0.025 -0.014 -0.034 0.019 -0.013 
Epoch 16 ( 2.72 sec) || train loss: 0.188 || test loss: 0.297
0.55 0.54 0.39 0.3 0.51 0.54 0.5 0.74 0.46 2.7 1.4 0.61 
-0.019 -0.014 -0.0076 -0.03 -0.019 -0.017 -0.016 -0.014 -0.0045 0.038 0.0021 -0.028 
Epoch 17 ( 2.7 sec) || train loss: 0.188 || test loss: 0.265
0.71 0.56 0.39 0.51 0.34 0.52 0.45 0.6 0.83 2.4 1.1 0.41 
0.011 0.0088 0.0036 0.007 0.0019 0.0067 0.0051 0.0077 0.013 0.046 0.019 0.0027 
Epoch 18 ( 2.71 sec) || train loss: 0.184 || test loss: 0.274
0.31 0.6 0.53 1 0.67 0.71 0.55 0.53 0.78 0.23 1.3 0.42 
-0.013 -0.005 -0.01 0.0045 -0.0083 -0.0075 -0.0084 -0.013 -0.0083 -0.02 0.007 -0.006 
Epoch 19 ( 2.71 sec) || train loss: 0.185 || test loss: 0.331
0.45 0.71 0.87 0.86 0.58 0.52 0.39 0.67 0.76 0.82 1.5 0.35 
-0.0069 -0.0081 -0.0056 0.0021 0.0013 -0.0093 -0.014 -9.3e-05 -0.0021 0.0022 0.012 -0.021 
Epoch 20 ( 2.94 sec) || train loss: 0.182 || test loss: 0.259
0.87 0.39 0.85 0.76 0.35 0.78 0.32 0.58 0.56 1.7 1.2 0.51 
0.0054 -0.013 -0.0086 -0.0013 -0.011 0.00058 -0.01 -0.0061 -0.013 0.017 0.012 -0.0065 
Epoch 21 ( 3.1 sec) || train loss: 0.181 || test loss: 0.239
0.3 0.51 0.54 0.39 0.54 0.54 0.36 0.56 0.58 1.9 1.6 0.33 
-0.011 -0.013 0.0038 -0.0069 -0.0082 -0.0075 -0.012 -0.0063 0.0063 0.024 0.02 -0.009 
Epoch 22 ( 2.97 sec) || train loss: 0.179 || test loss: 0.287
0.41 0.53 0.42 0.54 0.69 0.38 0.48 0.62 0.45 1.5 1.4 0.44 
0.012 0.014 0.012 0.015 0.018 0.011 0.013 0.018 0.012 0.034 0.033 0.013 
Epoch 23 ( 2.79 sec) || train loss: 0.181 || test loss: 0.294
0.51 0.6 0.6 0.47 0.6 0.53 0.63 0.33 0.03 2.3 1.3 0.63 
0.011 0.013 0.013 0.01 0.013 0.012 0.014 0.0072 0.00059 0.052 0.029 0.014 
Epoch 24 ( 2.87 sec) || train loss: 0.182 || test loss: 0.261
0.34 0.54 0.54 0.38 0.62 0.61 0.66 0.61 0.4 1 1.4 0.41 
-0.0042 -0.0073 -0.0084 -0.01 -0.0092 -0.011 -0.004 0.0015 -0.014 0.0054 0.013 -0.01 
Epoch 25 ( 2.74 sec) || train loss: 0.18 || test loss: 0.306
0.47 0.37 0.49 0.49 0.4 0.44 0.48 0.7 0.68 2.4 1.4 0.4 
0.016 0.012 0.016 0.015 0.013 0.014 0.014 0.019 0.02 0.056 0.034 0.012 
Epoch 26 ( 2.78 sec) || train loss: 0.179 || test loss: 0.256
0.88 0.51 0.96 0.57 0.63 0.76 0.97 0.54 1.1 0.24 1.2 0.85 
0.0078 -0.0026 0.0066 0.0019 0.0039 0.0072 0.011 0.0066 0.012 -0.006 0.017 0.012 
Epoch 27 ( 2.9 sec) || train loss: 0.181 || test loss: 0.222
0.44 0.68 0.56 0.76 0.58 0.6 0.67 0.51 0.82 0.62 1.4 0.52 
-0.0015 0.00074 0.0061 0.0078 0.004 0.0013 0.0031 -0.0012 0.012 0.0067 0.022 0.001 
Epoch 28 ( 2.71 sec) || train loss: 0.18 || test loss: 0.247
0.54 0.56 0.73 0.71 0.76 0.67 0.69 0.62 0.69 2.1 1.2 0.39 
0.0079 0.0081 0.01 0.01 0.011 0.0086 0.01 0.0076 0.011 0.04 0.022 0.0045 
Epoch 29 ( 2.72 sec) || train loss: 0.186 || test loss: 0.238
0.44 0.33 0.74 0.14 0.38 0.47 0.25 0.54 0.71 1.7 1.3 0.48 
-0.0034 -0.013 -0.0085 -0.014 -0.0029 -0.007 -0.014 -0.0066 -0.0037 0.016 0.016 -0.018 
Epoch 30 ( 2.71 sec) || train loss: 0.176 || test loss: 0.294
0.52 0.41 0.33 0.47 0.52 0.39 0.51 0.38 0.87 1.8 0.99 0.47 
-0.0015 -0.0044 -0.0089 -0.0031 -0.0029 -0.0072 -0.0018 -0.0061 0.0032 0.025 0.0073 -1.5e-05 
Epoch 31 ( 2.71 sec) || train loss: 0.176 || test loss: 0.286
0.48 0.59 0.62 0.51 0.53 0.42 0.69 0.36 0.46 1.8 1.3 0.42 
-0.011 -0.0014 -0.004 -0.0035 -0.0046 -0.00072 0.0007 -0.008 -0.0017 0.021 0.017 -0.0017 
Epoch 32 ( 2.71 sec) || train loss: 0.177 || test loss: 0.248
0.52 0.16 0.59 0.55 0.5 0.56 0.3 0.55 0.61 2 1.7 0.34 
-0.0014 -0.015 -0.0041 -0.0024 -0.0023 -0.0048 -0.012 -0.0041 -0.0061 0.029 0.024 -0.0055 
Epoch 33 ( 2.71 sec) || train loss: 0.176 || test loss: 0.255
0.075 0.58 0.83 0.6 -0.24 0.58 0.011 -1.6 0.7 4.7 0.58 0.3 
-0.016 -0.0095 -0.0018 -0.0054 -0.025 -0.012 -0.021 -0.065 0.0027 0.09 -0.0077 -0.01 
Epoch 34 ( 2.87 sec) || train loss: 0.175 || test loss: 0.476
1 0.34 0.66 0.64 0.6 0.73 1 0.21 0.59 0.38 0.77 0.62 
0.016 0.0018 0.0099 0.01 0.0095 0.012 0.02 -0.0019 0.0093 0.0033 0.013 0.011 
Epoch 35 ( 2.8 sec) || train loss: 0.176 || test loss: 0.264
0.7 0.5 0.41 0.35 0.39 0.27 0.43 0.27 0.44 2.1 1.4 0.36 
0.0076 0.0062 0.0035 0.0018 0.0023 -0.00034 0.0039 -0.0006 0.0048 0.043 0.025 0.0027 
Epoch 36 ( 2.82 sec) || train loss: 0.177 || test loss: 0.29
0.89 0.2 0.7 0.7 0.71 0.64 0.99 0.66 0.85 0.79 0.76 0.4 
0.0082 -0.016 -0.0006 0.002 0.0015 0.00015 0.0057 0.0011 0.0042 0.00056 0.0059 -0.0059 
Epoch 37 ( 2.86 sec) || train loss: 0.18 || test loss: 0.225
1.5 0.58 0.55 0.79 0.84 1 0.55 -0.61 0.86 0.61 0.46 0.39 
0.0076 -0.0029 -0.016 -0.0099 -0.0012 -0.0069 -0.0096 -0.043 -0.0065 -0.014 -0.02 -0.016 
Epoch 38 ( 2.7 sec) || train loss: 0.182 || test loss: 0.279
0.087 0.73 0.44 0.44 0.48 0.61 0.43 0.28 0.57 2.4 1.2 0.38 
-0.0042 0.013 0.0036 0.0047 0.005 0.0082 0.004 0.0025 0.0074 0.051 0.022 0.0023 
Epoch 39 ( 2.75 sec) || train loss: 0.182 || test loss: 0.273
0.28 0.57 1.1 0.51 0.71 0.72 0.14 0.82 0.95 1.4 0.39 0.78 
0.007 0.014 0.028 0.012 0.017 0.018 0.0037 0.02 0.023 0.033 0.0097 0.019 
Epoch 40 ( 2.72 sec) || train loss: 0.173 || test loss: 0.235
0.85 0.45 1 0.47 0.22 0.71 0.35 0.15 0.033 1.6 1.3 0.41 
-0.0072 -0.018 0.0031 -0.011 -0.015 0.00099 -0.0076 -0.0057 -0.024 0.014 0.013 -0.016 
Epoch 41 ( 2.78 sec) || train loss: 0.174 || test loss: 0.271
0.66 0.5 0.42 0.66 0.51 0.38 0.52 1 0.49 1.5 1.5 0.47 
0.017 0.013 0.012 0.017 0.014 0.011 0.014 0.026 0.013 0.038 0.037 0.012 
Epoch 42 ( 2.81 sec) || train loss: 0.174 || test loss: 0.232
0.29 0.56 0.52 0.45 0.26 0.4 0.74 0.42 0.44 1.8 1.1 0.55 
0.007 0.014 0.013 0.011 0.0062 0.0096 0.018 0.01 0.011 0.044 0.025 0.013 
Epoch 43 ( 2.83 sec) || train loss: 0.178 || test loss: 0.276
0.82 0.37 0.45 0.37 0.23 0.67 0.36 0.65 0.56 1.9 0.97 0.38 
0.025 0.012 0.015 0.012 0.0097 0.02 0.013 0.02 0.017 0.051 0.027 0.013 
Epoch 44 ( 2.8 sec) || train loss: 0.174 || test loss: 0.264
0.7 0.43 0.59 0.5 0.54 0.62 0.43 0.54 0.44 1.7 0.98 0.46 
0.016 0.0092 0.013 0.011 0.012 0.014 0.0093 0.012 0.01 0.04 0.023 0.01 
Epoch 45 ( 2.85 sec) || train loss: 0.178 || test loss: 0.243
0.72 0.31 0.47 0.6 0.71 0.71 0.88 0.51 0.68 1.7 0.55 0.39 
0.015 0.0061 0.0094 0.013 0.015 0.015 0.02 0.0098 0.015 0.038 0.012 0.0081 
Epoch 46 ( 2.7 sec) || train loss: 0.178 || test loss: 0.237
0.73 0.42 0.57 0.69 0.57 0.66 0.59 0.41 0.74 1.5 0.92 0.48 
0.018 0.01 0.014 0.017 0.014 0.016 0.015 0.01 0.018 0.036 0.023 0.012 
Epoch 47 ( 2.75 sec) || train loss: 0.181 || test loss: 0.227
0.55 0.37 0.6 0.52 0.48 0.34 0.41 0.47 0.18 1.9 1.3 0.48 
0.017 0.013 0.019 0.018 0.016 0.012 0.014 0.017 0.0091 0.051 0.036 0.016 
Epoch 48 ( 2.72 sec) || train loss: 0.178 || test loss: 0.269
0.36 0.48 0.59 0.69 0.38 0.47 0.45 0.46 0.56 2.2 1 0.61 
0.0037 0.0058 0.0091 0.012 0.0035 0.0071 0.0055 0.0043 0.0083 0.048 0.02 0.012 
Epoch 49 ( 3 sec) || train loss: 0.179 || test loss: 0.255
0.32 0.43 0.58 0.4 0.41 0.5 0.57 0.39 0.49 1.2 1.5 0.37 
0.0029 0.0057 0.0093 0.0052 0.0056 0.0071 0.01 0.0042 0.0067 0.028 0.033 0.0038 
Epoch 50 ( 2.82 sec) || train loss: 0.17 || test loss: 0.286
0.53 0.57 0.36 0.5 0.094 0.38 0.54 0.31 0.55 1.8 1.2 0.49 
0.0084 0.0073 0.0032 0.0055 -0.007 -0.00044 0.0028 0.0014 0.0066 0.04 0.024 0.0064 
Epoch 51 ( 2.8 sec) || train loss: 0.173 || test loss: 0.281
0.77 0.37 0.36 0.51 0.43 0.56 0.43 0.36 0.76 1.7 0.79 0.53 
0.0047 -0.0066 -0.014 -0.017 -0.018 -0.017 -0.011 -0.0033 -0.0088 0.023 -0.0081 -0.0085 
Epoch 52 ( 2.77 sec) || train loss: 0.174 || test loss: 0.263
0.2 0.34 0.35 0.55 0.39 0.36 1 0.54 1.2 1.1 1 0.2 
-0.02 -0.031 -0.028 -0.019 -0.016 -0.02 0.0022 -0.0062 0.0065 0.0031 0.0065 -0.029 
Epoch 53 ( 2.7 sec) || train loss: 0.179 || test loss: 0.273
1.9 -0.15 3 2.2 1.2 1.8 0.61 0.046 3.1 -4.6 2.7 2.8 
0.12 0.073 0.16 0.12 0.12 0.13 0.093 0.062 0.17 -0.046 0.15 0.16 
Epoch 54 ( 2.79 sec) || train loss: 0.173 || test loss: 1.15
0.27 -0.23 1.4 0.13 0.72 0.44 -0.00028 0.52 0.55 1.2 1.4 1.3 
-0.021 -0.027 0.0071 -0.015 -0.0025 -0.0088 -0.022 -0.012 -0.0039 0.0018 0.022 0.019 
Epoch 55 ( 2.81 sec) || train loss: 0.176 || test loss: 0.264
0.6 0.5 0.49 0.79 0.56 0.51 0.5 0.39 0.61 0.8 1.1 0.39 
-0.0025 -0.0039 -0.013 -0.004 -0.0076 -0.0045 -0.012 -0.021 -0.011 -0.0077 0.011 -0.0059 
Epoch 56 ( 2.79 sec) || train loss: 0.177 || test loss: 0.26
0.48 0.3 0.51 0.37 0.42 0.59 0.68 0.45 0.79 1.6 1.3 0.59 
0.011 0.0059 0.01 0.0076 0.0089 0.013 0.016 0.0096 0.019 0.038 0.032 0.014 
Epoch 57 ( 2.88 sec) || train loss: 0.175 || test loss: 0.24
0.34 0.44 0.46 0.51 0.53 0.23 0.83 0.56 0.49 1.7 1.2 0.36 
-0.0064 0.0027 0.0031 0.0045 -0.00012 -0.0037 0.0086 -0.0019 0.003 0.033 0.021 -0.0001 
Epoch 58 ( 2.92 sec) || train loss: 0.176 || test loss: 0.257
0.5 0.54 0.55 0.36 0.79 0.63 0.2 0.54 0.74 0.83 1.2 0.49 
-0.0088 -0.0099 -0.011 -0.015 0.0062 -0.0057 -0.0081 0.00032 -0.0017 0.012 0.0097 -0.015 
Epoch 59 ( 2.76 sec) || train loss: 0.174 || test loss: 0.253
^C
❯ g++ td_learning.cpp -std=c++20 -o td -O3
❯ ./td
1 1 1.2 1.1 1 1 1.4 3.1 1.9 
0.011 0.007 0.014 0.016 0.0082 0.016 0.014 0.035 0.027 
Epoch 1 ( 2.3 sec) || train loss: 0.797 || test loss: 0.603
0.92 1 0.87 0.95 1 0.94 0.92 2.8 1.9 
0.0031 -0.00043 0.0076 -0.0036 0.0039 -0.0014 -0.0028 0.012 0.027 
Epoch 2 ( 2.27 sec) || train loss: 0.488 || test loss: 0.468
0.95 0.94 1.1 0.94 0.97 0.95 1 2 2 
-0.0027 -0.0015 0.0047 -0.0042 -0.0062 -0.0075 0.00066 0.025 0.023 
Epoch 3 ( 2.29 sec) || train loss: 0.364 || test loss: 0.377
0.9 0.84 0.76 0.81 0.7 1.1 0.99 1.5 1.8 
-0.017 0.0022 -0.014 -0.014 -0.014 -0.0089 0.0021 0.018 0.015 
Epoch 4 ( 2.28 sec) || train loss: 0.304 || test loss: 0.382
0.91 0.95 0.72 0.87 0.79 1 1.2 1.1 1.8 
-0.0066 -0.0025 -0.00077 -0.001 -0.0011 -0.0081 0.0059 -0.0025 0.019 
Epoch 5 ( 2.27 sec) || train loss: 0.267 || test loss: 0.33
0.73 0.88 0.97 0.83 0.77 0.64 0.8 2.5 1.5 
-0.007 0.0095 0.0014 -0.003 -0.00028 -0.006 0.0077 0.045 0.013 
Epoch 6 ( 2.26 sec) || train loss: 0.245 || test loss: 0.287
1.2 0.5 0.88 0.84 0.98 0.62 0.81 1.4 1.7 
-0.013 -0.019 -0.004 -0.011 -0.0063 -0.026 -0.0057 0.0016 0.019 
Epoch 7 ( 2.29 sec) || train loss: 0.23 || test loss: 0.287
0.75 0.97 0.68 0.87 0.88 0.84 0.85 1.4 1.3 
-0.006 -0.002 -0.01 -0.0018 -0.0013 -0.0059 -0.0057 0.014 0.0017 
Epoch 8 ( 2.25 sec) || train loss: 0.22 || test loss: 0.286
0.84 0.41 0.78 0.72 0.88 0.76 0.71 2.5 1.4 
-0.0098 -0.028 -0.012 -0.0032 -0.0012 0.0022 -0.016 0.024 0.0015 
Epoch 9 ( 2.27 sec) || train loss: 0.211 || test loss: 0.255
0.66 0.85 0.9 0.66 0.84 0.75 0.44 1.4 1.6 
0.0048 0.0068 0.0071 0.0041 0.0079 0.008 0.00059 0.022 0.02 
Epoch 10 ( 2.25 sec) || train loss: 0.205 || test loss: 0.279
0.6 0.63 0.97 0.88 0.83 0.64 1 0.17 1.8 
-0.019 -0.0045 0.00016 -0.011 -0.0059 -0.029 0.0032 -0.019 0.019 
Epoch 11 ( 2.26 sec) || train loss: 0.201 || test loss: 0.313
0.58 0.89 0.62 0.76 0.84 0.75 0.71 0.8 1.8 
0.0083 0.014 0.009 0.012 0.013 0.012 0.0094 0.013 0.032 
Epoch 12 ( 2.25 sec) || train loss: 0.198 || test loss: 0.279
0.9 0.77 0.43 0.52 0.75 0.72 0.64 1.8 1.7 
0.0012 -0.011 -0.011 -0.0054 -0.0023 0.0062 -0.0076 0.021 0.017 
Epoch 13 ( 2.34 sec) || train loss: 0.196 || test loss: 0.239
0.64 0.39 0.47 0.72 0.5 0.82 0.63 2.1 0.91 
0.0066 0.00074 0.0053 0.0091 0.0051 0.0085 0.0072 0.037 0.014 
Epoch 14 ( 2.33 sec) || train loss: 0.193 || test loss: 0.312
1 0.75 0.7 0.49 0.93 0.34 0.84 2.8 1.3 
0.05 0.047 0.046 0.037 0.055 0.039 0.05 0.092 0.062 
Epoch 15 ( 2.35 sec) || train loss: 0.192 || test loss: 0.249
0.63 0.82 0.34 0.41 0.42 0.37 0.55 2.2 1.3 
-0.013 -0.012 -0.032 -0.016 -0.014 -0.013 -0.024 0.024 -0.0077 
Epoch 16 ( 2.38 sec) || train loss: 0.191 || test loss: 0.303
0.63 1.3 0.17 0.71 0.73 0.62 0.32 3 1.2 
0.0014 0.011 -0.0048 0.0029 0.005 0.0025 -0.0051 0.049 0.015 
Epoch 17 ( 2.45 sec) || train loss: 0.19 || test loss: 0.258
0.73 0.84 0.79 0.63 1 0.69 1 0.42 0.94 
0.0087 0.0094 0.009 0.0056 0.015 0.0071 0.013 0.0028 0.014 
Epoch 18 ( 2.5 sec) || train loss: 0.193 || test loss: 0.27
0.58 1 1 1 0.49 0.5 0.45 0.44 1.5 
-0.011 -0.0047 -0.01 0.0015 -0.0046 -0.0047 -0.024 -0.0066 0.0086 
Epoch 19 ( 2.38 sec) || train loss: 0.19 || test loss: 0.272
0.9 0.15 0.98 0.38 0.87 0.68 0.7 0.69 1.3 
-0.015 -0.033 -0.016 -0.028 -0.0081 -0.0095 -0.022 -0.034 0.0019 
Epoch 20 ( 2.37 sec) || train loss: 0.184 || test loss: 0.294
0.96 0.53 0.7 0.5 0.71 0.45 0.21 2.1 1.4 
0.0094 -0.014 0.0025 -0.012 -0.0087 -0.023 -0.013 0.014 0.015 
Epoch 21 ( 2.27 sec) || train loss: 0.185 || test loss: 0.243
0.61 0.82 0.58 0.56 0.4 0.38 0.58 2.3 1.2 
-0.018 -0.018 -0.021 -0.024 -0.026 -0.034 -0.024 0.0097 0.0044 
Epoch 22 ( 2.27 sec) || train loss: 0.186 || test loss: 0.253
0.57 0.61 0.46 0.43 0.55 0.38 0.59 1.7 1.7 
0.0036 -0.016 -0.013 -0.0037 -0.006 -0.00073 -0.01 0.021 0.011 
Epoch 23 ( 2.34 sec) || train loss: 0.188 || test loss: 0.266
0.68 0.69 0.11 0.83 0.65 0.46 0.58 1.5 1.5 
-0.0064 -0.011 -0.034 -0.014 -0.011 -0.0045 -0.0065 0.0052 0.0074 
Epoch 24 ( 2.44 sec) || train loss: 0.188 || test loss: 0.254
0.47 0.5 0.45 0.5 0.46 0.45 0.83 1.9 1.3 
-0.032 0.0021 -0.024 -0.041 -0.043 -0.066 0.0012 0.019 0.00084 
Epoch 25 ( 2.29 sec) || train loss: 0.187 || test loss: 0.265
0.69 0.68 0.64 0.59 0.38 0.61 0.84 2 1.2 
0.0033 0.0032 0.0067 0.003 -4.1e-05 0.0045 0.011 0.034 0.021 
Epoch 26 ( 2.28 sec) || train loss: 0.189 || test loss: 0.23
0.29 0.78 0.75 0.56 0.72 0.51 0.7 0.96 1.5 
-0.026 -0.002 -0.034 -0.018 -0.022 -0.012 -0.0024 -0.0056 -0.0051 
Epoch 27 ( 2.29 sec) || train loss: 0.188 || test loss: 0.258
0.77 0.59 0.41 0.84 0.52 0.25 0.62 1.7 0.6 
0.0026 -0.014 -0.0055 -0.0065 -0.01 -0.024 -0.008 0.012 -0.011 
Epoch 28 ( 2.28 sec) || train loss: 0.186 || test loss: 0.304
0.63 0.74 0.59 0.47 0.55 0.3 1.1 2 0.94 
0.03 0.03 0.025 0.021 0.023 0.02 0.037 0.057 0.034 
Epoch 29 ( 2.27 sec) || train loss: 0.188 || test loss: 0.237
0.62 0.81 0.75 0.54 0.34 0.47 0.79 2.4 1 
0.024 0.032 0.028 0.022 0.017 0.021 0.028 0.063 0.032 
Epoch 30 ( 2.37 sec) || train loss: 0.183 || test loss: 0.246
0.41 0.44 0.62 0.69 0.37 0.63 0.73 2 1.3 
0.01 0.011 0.015 0.017 0.0095 0.015 0.018 0.046 0.031 
Epoch 31 ( 2.28 sec) || train loss: 0.182 || test loss: 0.244
0.18 0.56 0.73 0.36 0.81 0.46 0.99 1.5 1.1 
-0.017 -0.0078 -0.0026 -0.01 -0.0033 -0.0066 0.01 0.014 0.011 
Epoch 32 ( 2.26 sec) || train loss: 0.184 || test loss: 0.255
0.53 0.74 0.25 0.75 0.72 0.82 0.76 0.48 1.4 
0.0082 0.013 0.0026 0.014 0.013 0.015 0.015 0.0079 0.03 
Epoch 33 ( 2.35 sec) || train loss: 0.185 || test loss: 0.269
0.63 0.52 0.52 0.48 0.45 0.38 0.62 2 1.3 
0.011 0.0094 0.01 0.008 0.0075 0.0052 0.012 0.041 0.029 
Epoch 34 ( 2.43 sec) || train loss: 0.186 || test loss: 0.254
0.6 0.64 0.62 0.45 0.6 0.65 0.52 1.7 1.3 
0.0079 0.0063 0.011 0.0044 0.0074 0.0014 0.0067 0.023 0.026 
Epoch 35 ( 2.37 sec) || train loss: 0.189 || test loss: 0.236
0.66 0.6 0.73 0.79 0.91 0.87 0.15 0.81 1.2 
0.0027 -0.0035 0.0049 0.01 0.009 0.012 -0.0081 0.0077 0.016 
Epoch 36 ( 2.65 sec) || train loss: 0.188 || test loss: 0.241
1 0.22 0.57 0.52 0.9 0.5 0.65 1.6 0.92 
0.027 0.0078 0.015 0.014 0.023 0.014 0.017 0.04 0.023 
Epoch 37 ( 2.75 sec) || train loss: 0.189 || test loss: 0.239
0.57 0.56 0.63 0.51 0.48 0.63 0.45 1.7 0.93 
0.02 0.02 0.021 0.018 0.018 0.022 0.015 0.044 0.03 
Epoch 38 ( 3.11 sec) || train loss: 0.195 || test loss: 0.271
0.86 0.89 1 0.32 0.7 0.29 0.81 0.75 1.1 
-0.00026 -0.0014 0.0042 -0.0098 -0.0011 -0.012 -0.0015 0.0028 0.0078 
Epoch 39 ( 3.75 sec) || train loss: 0.191 || test loss: 0.237
0.4 0.51 0.61 0.66 0.63 0.39 0.94 1.9 1.1 
0.00044 -0.00045 0.0068 0.0042 0.0031 -0.0037 0.012 0.033 0.021 
Epoch 40 ( 3.83 sec) || train loss: 0.183 || test loss: 0.24
0.34 0.52 0.5 0.42 0.57 0.46 0.78 2.2 1.1 
-0.015 -0.0092 -0.0053 -0.0098 -0.0057 -0.016 -0.0019 0.034 0.01 
Epoch 41 ( 7.2 sec) || train loss: 0.181 || test loss: 0.262
0.57 0.32 0.98 0.49 0.42 0.46 0.62 1.1 1.3 
-0.012 -0.0034 0.0034 -0.022 -0.016 -0.011 0.0078 0.011 0.015 
Epoch 42 ( 6.57 sec) || train loss: 0.186 || test loss: 0.269
^C
❯ g++ td_learning.cpp -std=c++20 -o td -O3
❯ ./td
0.11 0.16 0.12 0.071 0.1 0.22 1.7 1.9 0.48 
0.0022 0.0032 0.0024 0.0014 0.002 0.0045 0.033 0.039 -0.06 
Epoch 1 ( 2.31 sec) || train loss: 0.118 || test loss: 0.0846
0.12 0.3 0.13 0.25 0.12 0.38 3.3 1.8 0.38 
0.0024 0.0059 0.0027 0.005 0.0024 0.0075 0.066 0.035 -0.0029 
Epoch 2 ( 2.3 sec) || train loss: 0.0995 || test loss: 0.105
-0.065 0.3 0.31 0.39 0.38 0.49 1.2 1.8 0.33 
-0.0013 0.006 0.0063 0.0078 0.0076 0.0099 0.024 0.037 -0.011 
Epoch 3 ( 2.46 sec) || train loss: 0.0996 || test loss: 0.0839
0.41 0.2 0.12 0.24 0.12 0.23 2.5 1.9 0.3 
0.0081 0.004 0.0025 0.0048 0.0023 0.0045 0.05 0.038 -0.022 
Epoch 4 ( 2.58 sec) || train loss: 0.102 || test loss: 0.1
0.19 0.33 0.14 0.56 0.19 0.21 1.2 1.6 0.28 
0.0038 0.0066 0.0028 0.011 0.0038 0.0041 0.025 0.033 0.0041 
Epoch 5 ( 2.68 sec) || train loss: 0.103 || test loss: 0.09
0.47 0.32 0.25 0.3 0.32 0.29 2.8 1.4 0.27 
0.0094 0.0065 0.0049 0.0059 0.0065 0.0057 0.056 0.028 -0.011 
Epoch 6 ( 2.76 sec) || train loss: 0.105 || test loss: 0.115
0.95 0.31 0.34 0.094 -0.25 -0.37 2 1.7 0.26 
0.019 0.0062 0.0067 0.0018 -0.0051 -0.0074 0.039 0.035 -0.043 
Epoch 7 ( 2.85 sec) || train loss: 0.109 || test loss: 0.106
0.63 0.32 0.51 0.81 0.24 0.64 0.63 1.7 0.24 
0.013 0.0064 0.01 0.016 0.0048 0.013 0.013 0.034 -0.0055 
Epoch 8 ( 2.85 sec) || train loss: 0.112 || test loss: 0.0986
0.78 0.51 0.35 0.52 0.36 0.29 1.4 1.5 0.25 
0.016 0.01 0.0068 0.01 0.0072 0.0057 0.029 0.03 -0.083 
Epoch 9 ( 3.18 sec) || train loss: 0.114 || test loss: 0.124
0.33 0.29 0.3 0.19 0.22 0.74 2.1 1.3 0.23 
0.007 0.0062 0.0063 0.004 0.0047 0.016 0.043 0.027 -0.0099 
Epoch 10 ( 2.83 sec) || train loss: 0.113 || test loss: 0.112
0.2 0.36 0.41 0.15 0.2 0.3 0.69 1.4 0.22 
0.0042 0.0076 0.0086 0.0032 0.0042 0.0063 0.015 0.028 0.0017 
Epoch 11 ( 2.81 sec) || train loss: 0.116 || test loss: 0.0878
0.14 0.6 0.4 -0.25 0.16 -0.097 2.2 1.4 0.22 
0.0029 0.013 0.0084 -0.0054 0.0034 -0.0021 0.046 0.03 -0.04 
Epoch 12 ( 2.87 sec) || train loss: 0.118 || test loss: 0.123
0.38 0.31 0.38 0.38 0.47 0.59 2.1 1.4 0.22 
0.0078 0.0065 0.008 0.0079 0.0098 0.012 0.044 0.029 -0.096 
Epoch 13 ( 2.89 sec) || train loss: 0.122 || test loss: 0.138
0.49 0.57 0.5 0.95 0.49 0.55 2.3 1.2 0.21 
0.01 0.012 0.011 0.02 0.01 0.011 0.048 0.025 0.0012 
Epoch 14 ( 2.93 sec) || train loss: 0.124 || test loss: 0.136
0.66 0.25 0.4 0.29 0.28 0.057 1.5 1.4 0.2 
0.014 0.0052 0.0084 0.006 0.0059 0.0012 0.032 0.029 -0.01 
Epoch 15 ( 3.27 sec) || train loss: 0.126 || test loss: 0.109
0.056 -0.0082 0.15 0.18 0.28 0.78 2.2 1.7 0.2 
0.0012 -0.00018 0.0031 0.0037 0.0058 0.016 0.047 0.035 -0.011 
Epoch 16 ( 2.85 sec) || train loss: 0.129 || test loss: 0.143
0.22 0.15 0.38 0.0075 0.37 0.29 1.5 1.5 0.21 
0.0046 0.0031 0.008 0.00012 0.0078 0.0059 0.032 0.032 0.24 
Epoch 17 ( 3 sec) || train loss: 0.131 || test loss: 0.146
0.62 0.66 0.33 0.95 0.55 0.53 2 1.2 0.19 
0.013 0.014 0.0069 0.02 0.012 0.011 0.042 0.026 0.0034 
Epoch 18 ( 2.78 sec) || train loss: 0.132 || test loss: 0.14
0.58 0.65 0.2 0.33 0.19 0.6 1.8 1 0.19 
0.012 0.014 0.0041 0.007 0.0039 0.013 0.039 0.022 -0.042 
Epoch 19 ( 2.77 sec) || train loss: 0.139 || test loss: 0.128
0.64 0.21 0.44 0.35 0.14 0.48 2.1 1.4 0.19 
0.014 0.0047 0.0096 0.0077 0.0031 0.011 0.046 0.032 0.0029 
Epoch 20 ( 2.75 sec) || train loss: 0.131 || test loss: 0.142
0.39 1 0.32 0.78 0.39 -0.031 1.8 1.5 0.19 
0.0085 0.023 0.0072 0.017 0.0086 -0.00069 0.039 0.033 -0.0051 
Epoch 21 ( 2.76 sec) || train loss: 0.131 || test loss: 0.142

❯ g++ td_learning.cpp -std=c++20 -o td -O3
❯ ./td
1.1 1.2 1.1 1.1 1.2 2.9 2.5 
-0.0043 0.0043 0.0059 0.01 0.0043 0.041 0.033 
Epoch 1 ( 1.93 sec) || train loss: 0.768 || test loss: 0.578
1.1 1.2 1.1 1.2 1.3 1.3 2.2 
-0.0031 0.0062 -0.0018 0.0014 0.0038 -0.003 0.014 
Epoch 2 ( 1.92 sec) || train loss: 0.457 || test loss: 0.457
0.82 0.94 0.98 0.99 1.1 3.1 1.7 
-0.022 -0.016 -0.021 -0.022 0.014 0.05 -0.00038 
Epoch 3 ( 1.87 sec) || train loss: 0.341 || test loss: 0.346
1.1 1 1 1 1 2.5 1.2 
0.00079 -0.0044 -0.0047 0.00052 -0.015 0.015 0.0029 
Epoch 4 ( 1.87 sec) || train loss: 0.287 || test loss: 0.32
0.72 0.75 0.76 0.71 0.88 2.5 1.8 
0.0092 0.0076 0.0088 0.0083 0.012 0.045 0.03 
Epoch 5 ( 1.84 sec) || train loss: 0.256 || test loss: 0.322
0.74 0.82 0.8 0.71 0.81 2.4 1.9 
-0.0069 -0.0081 -0.006 -0.015 -0.012 0.0069 0.015 
Epoch 6 ( 1.93 sec) || train loss: 0.238 || test loss: 0.28
0.89 0.76 0.81 0.72 0.97 2.2 1.5 
-0.004 0.00021 -0.0031 -0.012 0.0061 0.016 0.014 
Epoch 7 ( 1.84 sec) || train loss: 0.225 || test loss: 0.271
0.49 0.73 0.68 0.72 0.68 2.7 1.7 
-0.013 -0.0095 -0.0086 -0.005 -0.011 0.031 0.013 
Epoch 8 ( 1.92 sec) || train loss: 0.216 || test loss: 0.276
0.8 0.73 0.65 0.54 0.91 1.8 1.8 
-0.0022 -0.01 -0.022 -0.0071 -0.016 -0.0056 0.0016 
Epoch 9 ( 1.87 sec) || train loss: 0.21 || test loss: 0.27
0.67 0.79 0.71 0.7 0.74 2.4 1.4 
0.006 0.011 0.0068 0.0054 0.0075 0.043 0.023 
Epoch 10 ( 1.85 sec) || train loss: 0.206 || test loss: 0.257
0.88 0.62 0.96 0.53 0.85 2.5 0.7 
0.0025 -0.0087 -5.3e-05 -0.0076 -0.0023 0.034 -0.0039 
Epoch 11 ( 1.85 sec) || train loss: 0.203 || test loss: 0.276
1.4 1 0.3 0.51 0.79 0.54 2 
-0.00013 -0.01 -0.031 -0.013 -0.014 -0.013 0.0081 
Epoch 12 ( 1.85 sec) || train loss: 0.2 || test loss: 0.284
1.2 0.82 0.76 0.36 1.1 1.5 1.4 
0.024 0.016 0.015 0.0065 0.022 0.03 0.028 
Epoch 13 ( 1.89 sec) || train loss: 0.199 || test loss: 0.231
0.61 0.71 0.55 0.52 0.58 2.3 1.6 
-0.01 -0.0054 -0.0085 -0.0053 -0.0083 0.031 0.017 
Epoch 14 ( 1.87 sec) || train loss: 0.196 || test loss: 0.256
0.73 0.7 0.76 0.74 0.54 2.2 1.3 
-9.8e-05 -0.0021 -0.00082 -0.00012 -0.011 0.026 0.0066 
Epoch 15 ( 1.92 sec) || train loss: 0.197 || test loss: 0.242
0.71 0.91 0.66 0.43 0.74 0.85 1.6 
-0.034 -0.017 -0.018 -0.025 -0.036 -0.04 0.0013 
Epoch 16 ( 1.87 sec) || train loss: 0.198 || test loss: 0.298
0.45 1.1 0.45 0.64 1.1 1.9 1.4 
0.026 0.04 0.023 0.031 0.042 0.057 0.045 
Epoch 17 ( 1.92 sec) || train loss: 0.197 || test loss: 0.232
0.78 0.5 1 0.81 0.94 1.9 1.3 
0.0058 0.0014 0.014 0.0073 0.012 0.029 0.017 
Epoch 18 ( 1.87 sec) || train loss: 0.2 || test loss: 0.232
0.99 0.5 1 0.29 0.78 1.5 1.2 
0.0046 -0.026 -0.0064 -0.0088 -0.011 0.00099 -0.012 
Epoch 19 ( 1.84 sec) || train loss: 0.198 || test loss: 0.249
0.66 0.78 0.44 0.87 0.15 2.3 1.2 
0.0081 0.012 0.005 0.015 -0.0022 0.045 0.022 
Epoch 20 ( 1.84 sec) || train loss: 0.191 || test loss: 0.26
0.76 1.3 0.68 0.69 0.62 1.5 1.2 
0.027 0.035 0.025 0.026 0.023 0.046 0.035 
Epoch 21 ( 1.94 sec) || train loss: 0.195 || test loss: 0.222
^C